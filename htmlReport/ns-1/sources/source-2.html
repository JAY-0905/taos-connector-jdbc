


<!DOCTYPE html>
<html id="htmlId">
<head>
  <title>Coverage Report > AbstractDatabaseMetaData</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">com.taosdata.jdbc</a>
</div>

<h1>Coverage Summary for Class: AbstractDatabaseMetaData (com.taosdata.jdbc)</h1>

<table class="coverageStats">
<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Class, %
</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">AbstractDatabaseMetaData</td>
<td class="coverageStat">
  <span class="percent">
    100%
  </span>
  <span class="absValue">
    (1/1)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    99.5%
  </span>
  <span class="absValue">
    (218/219)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    90%
  </span>
  <span class="absValue">
    (753/837)
  </span>
</td>
</tr>

</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;package com.taosdata.jdbc;
&nbsp;
&nbsp;import com.taosdata.jdbc.enums.DataType;
&nbsp;import com.taosdata.jdbc.utils.StringUtils;
&nbsp;import com.taosdata.jdbc.ws.WSConnection;
&nbsp;
&nbsp;import java.io.FileWriter;
&nbsp;import java.io.IOException;
&nbsp;import java.io.InputStream;
&nbsp;import java.net.URL;
&nbsp;import java.sql.*;
&nbsp;import java.util.*;
&nbsp;import java.util.regex.Matcher;
&nbsp;import java.util.regex.Pattern;
&nbsp;
<b class="fc">&nbsp;public abstract class AbstractDatabaseMetaData extends WrapperImpl implements DatabaseMetaData {</b>
&nbsp;
&nbsp;    private static final String PRODUCT_NAME;
&nbsp;    private static final String PRODUCT_VERSION;
&nbsp;    private static final String DRIVER_VERSION;
&nbsp;    private static final int DRIVER_MAJAR_VERSION;
&nbsp;    private static final int DRIVER_MINOR_VERSION;
&nbsp;
&nbsp;    static {
<b class="fc">&nbsp;        Properties props = System.getProperties();</b>
&nbsp;        try {
<b class="fc">&nbsp;            props.load(loadProperties());</b>
<b class="nc">&nbsp;        } catch (IOException e) {</b>
&nbsp;            //ignore
<b class="fc">&nbsp;        }</b>
<b class="fc">&nbsp;        PRODUCT_NAME = props.getProperty(&quot;PRODUCT_NAME&quot;);</b>
<b class="fc">&nbsp;        PRODUCT_VERSION = props.getProperty(&quot;PRODUCT_VERSION&quot;);</b>
<b class="fc">&nbsp;        DRIVER_VERSION = props.getProperty(&quot;DRIVER_VERSION&quot;);</b>
<b class="fc">&nbsp;        DRIVER_MAJAR_VERSION = Integer.parseInt(DRIVER_VERSION.split(&quot;\\.&quot;)[0]);</b>
<b class="fc">&nbsp;        DRIVER_MINOR_VERSION = Integer.parseInt(DRIVER_VERSION.split(&quot;\\.&quot;)[1]);</b>
&nbsp;    }
&nbsp;
&nbsp;    private static InputStream loadProperties() throws IOException {
<b class="fc">&nbsp;        String currentJar = AbstractDatabaseMetaData.class.getProtectionDomain().getCodeSource().getLocation().getFile();</b>
<b class="fc">&nbsp;        Enumeration&lt;URL&gt; urls = AbstractDatabaseMetaData.class.getClassLoader().getResources(&quot;version.properties&quot;);</b>
<b class="fc">&nbsp;        while (urls.hasMoreElements()) {</b>
<b class="fc">&nbsp;            URL url = urls.nextElement();</b>
<b class="fc">&nbsp;            if (url.getFile().contains(currentJar)) {</b>
<b class="fc">&nbsp;                return url.openStream();</b>
&nbsp;            }
<b class="nc">&nbsp;        }</b>
<b class="nc">&nbsp;        return null;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean allProceduresAreCallable() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean allTablesAreSelectable() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public abstract String getURL() throws SQLException;
&nbsp;
&nbsp;    public abstract String getUserName() throws SQLException;
&nbsp;
&nbsp;    public boolean isReadOnly() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean nullsAreSortedHigh() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean nullsAreSortedLow() throws SQLException {
<b class="fc">&nbsp;        return !nullsAreSortedHigh();</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean nullsAreSortedAtStart() throws SQLException {
<b class="fc">&nbsp;        return true;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean nullsAreSortedAtEnd() throws SQLException {
<b class="fc">&nbsp;        return !nullsAreSortedAtStart();</b>
&nbsp;    }
&nbsp;
&nbsp;    public String getDatabaseProductName() throws SQLException {
<b class="fc">&nbsp;        return PRODUCT_NAME;</b>
&nbsp;    }
&nbsp;
&nbsp;    public String getDatabaseProductVersion() throws SQLException {
&nbsp;
<b class="fc">&nbsp;        Connection conn = getConnection();</b>
<b class="fc">&nbsp;        if (conn == null || conn.isClosed()) {</b>
<b class="nc">&nbsp;            throw TSDBError.createSQLException(TSDBErrorNumbers.ERROR_CONNECTION_CLOSED);</b>
&nbsp;        }
&nbsp;
<b class="fc">&nbsp;        String version = null;</b>
<b class="fc">&nbsp;        try (Statement stmt = conn.createStatement();</b>
<b class="fc">&nbsp;             ResultSet rs = stmt.executeQuery(&quot;select server_version()  as version&quot;)) {</b>
<b class="fc">&nbsp;            while (rs.next()) {</b>
<b class="fc">&nbsp;                version = rs.getString(&quot;version&quot;);</b>
&nbsp;            }
<b class="fc">&nbsp;        }</b>
&nbsp;
<b class="fc">&nbsp;        if (StringUtils.isEmpty(version)) {</b>
<b class="nc">&nbsp;            return PRODUCT_VERSION;</b>
&nbsp;        } else {
<b class="fc">&nbsp;            return version;</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    public abstract String getDriverName() throws SQLException;
&nbsp;
&nbsp;    public String getDriverVersion() throws SQLException {
<b class="fc">&nbsp;        return DRIVER_VERSION;</b>
&nbsp;    }
&nbsp;
&nbsp;    public int getDriverMajorVersion() {
<b class="fc">&nbsp;        return DRIVER_MAJAR_VERSION;</b>
&nbsp;    }
&nbsp;
&nbsp;    public int getDriverMinorVersion() {
<b class="fc">&nbsp;        return DRIVER_MINOR_VERSION;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean usesLocalFiles() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean usesLocalFilePerTable() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsMixedCaseIdentifiers() throws SQLException {
<b class="fc">&nbsp;        return false;   //像database、table这些对象的标识符，在存储时是否采用大小写混合的模式</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean storesUpperCaseIdentifiers() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean storesLowerCaseIdentifiers() throws SQLException {
<b class="fc">&nbsp;        return true;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean storesMixedCaseIdentifiers() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsMixedCaseQuotedIdentifiers() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean storesUpperCaseQuotedIdentifiers() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean storesLowerCaseQuotedIdentifiers() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean storesMixedCaseQuotedIdentifiers() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public String getIdentifierQuoteString() throws SQLException {
<b class="fc">&nbsp;        return &quot; &quot;;</b>
&nbsp;    }
&nbsp;
&nbsp;    public String getSQLKeywords() throws SQLException {
<b class="fc">&nbsp;        return null;</b>
&nbsp;    }
&nbsp;
&nbsp;    public String getNumericFunctions() throws SQLException {
<b class="fc">&nbsp;        return null;</b>
&nbsp;    }
&nbsp;
&nbsp;    public String getStringFunctions() throws SQLException {
<b class="fc">&nbsp;        return null;</b>
&nbsp;    }
&nbsp;
&nbsp;    public String getSystemFunctions() throws SQLException {
<b class="fc">&nbsp;        return null;</b>
&nbsp;    }
&nbsp;
&nbsp;    public String getTimeDateFunctions() throws SQLException {
<b class="fc">&nbsp;        return null;</b>
&nbsp;    }
&nbsp;
&nbsp;    public String getSearchStringEscape() throws SQLException {
<b class="fc">&nbsp;        return null;</b>
&nbsp;    }
&nbsp;
&nbsp;    public String getExtraNameCharacters() throws SQLException {
<b class="fc">&nbsp;        return null;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsAlterTableWithAddColumn() throws SQLException {
<b class="fc">&nbsp;        return true;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsAlterTableWithDropColumn() throws SQLException {
<b class="fc">&nbsp;        return true;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsColumnAliasing() throws SQLException {
<b class="fc">&nbsp;        return true;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean nullPlusNonNullIsNull() throws SQLException {
&nbsp;        // null + non-null != null
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsConvert() throws SQLException {
&nbsp;        // 是否支持转换函数convert
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsConvert(int fromType, int toType) throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsTableCorrelationNames() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsDifferentTableCorrelationNames() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsExpressionsInOrderBy() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsOrderByUnrelated() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsGroupBy() throws SQLException {
<b class="fc">&nbsp;        return true;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsGroupByUnrelated() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsGroupByBeyondSelect() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsLikeEscapeClause() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsMultipleResultSets() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsMultipleTransactions() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsNonNullableColumns() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsMinimumSQLGrammar() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsCoreSQLGrammar() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsExtendedSQLGrammar() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsANSI92EntryLevelSQL() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsANSI92IntermediateSQL() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsANSI92FullSQL() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsIntegrityEnhancementFacility() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsOuterJoins() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsFullOuterJoins() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsLimitedOuterJoins() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public String getSchemaTerm() throws SQLException {
<b class="fc">&nbsp;        return null;</b>
&nbsp;    }
&nbsp;
&nbsp;    public String getProcedureTerm() throws SQLException {
<b class="fc">&nbsp;        return null;</b>
&nbsp;    }
&nbsp;
&nbsp;    public String getCatalogTerm() throws SQLException {
<b class="fc">&nbsp;        return &quot;database&quot;;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean isCatalogAtStart() throws SQLException {
<b class="fc">&nbsp;        return true;</b>
&nbsp;    }
&nbsp;
&nbsp;    public String getCatalogSeparator() throws SQLException {
<b class="fc">&nbsp;        return &quot;.&quot;;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsSchemasInDataManipulation() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsSchemasInProcedureCalls() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsSchemasInTableDefinitions() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsSchemasInIndexDefinitions() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsSchemasInPrivilegeDefinitions() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsCatalogsInDataManipulation() throws SQLException {
<b class="fc">&nbsp;        return true;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsCatalogsInProcedureCalls() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsCatalogsInTableDefinitions() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsCatalogsInIndexDefinitions() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsCatalogsInPrivilegeDefinitions() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsPositionedDelete() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsPositionedUpdate() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsSelectForUpdate() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsStoredProcedures() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsSubqueriesInComparisons() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsSubqueriesInExists() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsSubqueriesInIns() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsSubqueriesInQuantifieds() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsCorrelatedSubqueries() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsUnion() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsUnionAll() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsOpenCursorsAcrossCommit() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsOpenCursorsAcrossRollback() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsOpenStatementsAcrossCommit() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsOpenStatementsAcrossRollback() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public int getMaxBinaryLiteralLength() throws SQLException {
<b class="fc">&nbsp;        return 0;</b>
&nbsp;    }
&nbsp;
&nbsp;    public int getMaxCharLiteralLength() throws SQLException {
<b class="fc">&nbsp;        return 0;</b>
&nbsp;    }
&nbsp;
&nbsp;    public int getMaxColumnNameLength() throws SQLException {
<b class="fc">&nbsp;        return 0;</b>
&nbsp;    }
&nbsp;
&nbsp;    public int getMaxColumnsInGroupBy() throws SQLException {
<b class="fc">&nbsp;        return 0;</b>
&nbsp;    }
&nbsp;
&nbsp;    public int getMaxColumnsInIndex() throws SQLException {
<b class="fc">&nbsp;        return 0;</b>
&nbsp;    }
&nbsp;
&nbsp;    public int getMaxColumnsInOrderBy() throws SQLException {
<b class="fc">&nbsp;        return 0;</b>
&nbsp;    }
&nbsp;
&nbsp;    public int getMaxColumnsInSelect() throws SQLException {
<b class="fc">&nbsp;        return 0;</b>
&nbsp;    }
&nbsp;
&nbsp;    public int getMaxColumnsInTable() throws SQLException {
<b class="fc">&nbsp;        return 0;</b>
&nbsp;    }
&nbsp;
&nbsp;    public int getMaxConnections() throws SQLException {
<b class="fc">&nbsp;        return 0;</b>
&nbsp;    }
&nbsp;
&nbsp;    public int getMaxCursorNameLength() throws SQLException {
<b class="fc">&nbsp;        return 0;</b>
&nbsp;    }
&nbsp;
&nbsp;    public int getMaxIndexLength() throws SQLException {
<b class="fc">&nbsp;        return 0;</b>
&nbsp;    }
&nbsp;
&nbsp;    public int getMaxSchemaNameLength() throws SQLException {
<b class="fc">&nbsp;        return 0;</b>
&nbsp;    }
&nbsp;
&nbsp;    public int getMaxProcedureNameLength() throws SQLException {
<b class="fc">&nbsp;        return 0;</b>
&nbsp;    }
&nbsp;
&nbsp;    public int getMaxCatalogNameLength() throws SQLException {
<b class="fc">&nbsp;        return 0;</b>
&nbsp;    }
&nbsp;
&nbsp;    public int getMaxRowSize() throws SQLException {
<b class="fc">&nbsp;        return 0;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean doesMaxRowSizeIncludeBlobs() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public int getMaxStatementLength() throws SQLException {
<b class="fc">&nbsp;        return 0;</b>
&nbsp;    }
&nbsp;
&nbsp;    public int getMaxStatements() throws SQLException {
<b class="fc">&nbsp;        return 0;</b>
&nbsp;    }
&nbsp;
&nbsp;    public int getMaxTableNameLength() throws SQLException {
<b class="fc">&nbsp;        return 0;</b>
&nbsp;    }
&nbsp;
&nbsp;    public int getMaxTablesInSelect() throws SQLException {
<b class="fc">&nbsp;        return 0;</b>
&nbsp;    }
&nbsp;
&nbsp;    public int getMaxUserNameLength() throws SQLException {
<b class="fc">&nbsp;        return 0;</b>
&nbsp;    }
&nbsp;
&nbsp;    public int getDefaultTransactionIsolation() throws SQLException {
<b class="fc">&nbsp;        return Connection.TRANSACTION_NONE;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsTransactions() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsTransactionIsolationLevel(int level) throws SQLException {
<b class="fc">&nbsp;        if (level == Connection.TRANSACTION_NONE)</b>
<b class="fc">&nbsp;            return true;</b>
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsDataDefinitionAndDataManipulationTransactions() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsDataManipulationTransactionsOnly() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean dataDefinitionCausesTransactionCommit() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean dataDefinitionIgnoredInTransactions() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public ResultSet getProcedures(String catalog, String schemaPattern, String procedureNamePattern) throws SQLException {
<b class="fc">&nbsp;        return null;</b>
&nbsp;    }
&nbsp;
&nbsp;    public ResultSet getProcedureColumns(String catalog, String schemaPattern, String procedureNamePattern, String columnNamePattern) throws SQLException {
<b class="fc">&nbsp;        return null;</b>
&nbsp;    }
&nbsp;
&nbsp;    public abstract ResultSet getTables(String catalog, String schemaPattern, String tableNamePattern, String[] types) throws SQLException;
&nbsp;
&nbsp;    private List&lt;ColumnMetaData&gt; buildGetTablesColumnMetaDataList() {
<b class="fc">&nbsp;        List&lt;ColumnMetaData&gt; columnMetaDataList = new ArrayList&lt;&gt;();</b>
<b class="fc">&nbsp;        columnMetaDataList.add(buildTableCatalogMeta(1));          // 1. TABLE_CAT</b>
<b class="fc">&nbsp;        columnMetaDataList.add(buildTableSchemaMeta(2));           // 2. TABLE_SCHEM</b>
<b class="fc">&nbsp;        columnMetaDataList.add(buildTableNameMeta(3));             // 3. TABLE_NAME</b>
<b class="fc">&nbsp;        columnMetaDataList.add(buildTableTypeMeta(4));             // 4. TABLE_TYPE</b>
<b class="fc">&nbsp;        columnMetaDataList.add(buildRemarksMeta(5));                // 5. remarks</b>
<b class="fc">&nbsp;        columnMetaDataList.add(buildTypeCatMeta(6));                // 6. TYPE_CAT</b>
<b class="fc">&nbsp;        columnMetaDataList.add(buildTypeSchemaMeta(7));             // 7. TYPE_SCHEM</b>
<b class="fc">&nbsp;        columnMetaDataList.add(buildTypeNameMeta(8));               // 8. TYPE_NAME</b>
<b class="fc">&nbsp;        columnMetaDataList.add(buildSelfReferencingColName(9));     // 9. SELF_REFERENCING_COL_NAME</b>
<b class="fc">&nbsp;        columnMetaDataList.add(buildRefGenerationMeta(10));         // 10. REF_GENERATION</b>
<b class="fc">&nbsp;        return columnMetaDataList;</b>
&nbsp;    }
&nbsp;
&nbsp;    private ColumnMetaData buildTypeCatMeta(int colIndex) {
<b class="fc">&nbsp;        ColumnMetaData col6 = new ColumnMetaData();</b>
<b class="fc">&nbsp;        col6.setColIndex(colIndex);</b>
<b class="fc">&nbsp;        col6.setColName(&quot;TYPE_CAT&quot;);</b>
<b class="fc">&nbsp;        col6.setColType(TSDBConstants.TSDB_DATA_TYPE_NCHAR);</b>
<b class="fc">&nbsp;        return col6;</b>
&nbsp;    }
&nbsp;
&nbsp;    private ColumnMetaData buildTypeSchemaMeta(int colIndex) {
<b class="fc">&nbsp;        ColumnMetaData col7 = new ColumnMetaData();</b>
<b class="fc">&nbsp;        col7.setColIndex(colIndex);</b>
<b class="fc">&nbsp;        col7.setColName(&quot;TYPE_SCHEM&quot;);</b>
<b class="fc">&nbsp;        col7.setColType(TSDBConstants.TSDB_DATA_TYPE_NCHAR);</b>
<b class="fc">&nbsp;        return col7;</b>
&nbsp;    }
&nbsp;
&nbsp;    private ColumnMetaData buildTypeNameMeta(int colIndex) {
<b class="fc">&nbsp;        ColumnMetaData col8 = new ColumnMetaData();</b>
<b class="fc">&nbsp;        col8.setColIndex(colIndex);</b>
<b class="fc">&nbsp;        col8.setColName(&quot;TYPE_NAME&quot;);</b>
<b class="fc">&nbsp;        col8.setColType(TSDBConstants.TSDB_DATA_TYPE_NCHAR);</b>
<b class="fc">&nbsp;        return col8;</b>
&nbsp;    }
&nbsp;
&nbsp;    private ColumnMetaData buildSelfReferencingColName(int colIndex) {
<b class="fc">&nbsp;        ColumnMetaData col9 = new ColumnMetaData();</b>
<b class="fc">&nbsp;        col9.setColIndex(colIndex);</b>
<b class="fc">&nbsp;        col9.setColName(&quot;SELF_REFERENCING_COL_NAME&quot;);</b>
<b class="fc">&nbsp;        col9.setColType(TSDBConstants.TSDB_DATA_TYPE_NCHAR);</b>
<b class="fc">&nbsp;        return col9;</b>
&nbsp;    }
&nbsp;
&nbsp;    private ColumnMetaData buildRefGenerationMeta(int colIndex) {
<b class="fc">&nbsp;        ColumnMetaData col10 = new ColumnMetaData();</b>
<b class="fc">&nbsp;        col10.setColIndex(colIndex);</b>
<b class="fc">&nbsp;        col10.setColName(&quot;REF_GENERATION&quot;);</b>
<b class="fc">&nbsp;        col10.setColType(TSDBConstants.TSDB_DATA_TYPE_NCHAR);</b>
<b class="fc">&nbsp;        return col10;</b>
&nbsp;    }
&nbsp;
&nbsp;    protected ResultSet getTables(String catalog, String schemaPattern, String tableNamePattern, String[] types, Connection connection) throws SQLException {
<b class="fc">&nbsp;        try (FileWriter fileWriter = new FileWriter(&quot;./1234567out.txt&quot;, true)) {</b>
<b class="fc">&nbsp;            fileWriter.append(&quot;**********************************************************\n&quot;);</b>
<b class="fc">&nbsp;            fileWriter.append(&quot;catalog:&quot; + catalog + &quot;\n&quot;);</b>
<b class="fc">&nbsp;            fileWriter.append(&quot;schemaPattern:&quot; + schemaPattern + &quot;\n&quot;);</b>
<b class="fc">&nbsp;            fileWriter.append(&quot;tableNamePattern:&quot; + tableNamePattern + &quot;\n&quot;);</b>
<b class="fc">&nbsp;            if (types != null) {</b>
<b class="nc">&nbsp;                for (String item : types) {</b>
<b class="nc">&nbsp;                    fileWriter.append(&quot;types:&quot; + item + &quot;\n&quot;);</b>
&nbsp;                }
&nbsp;            }
<b class="fc">&nbsp;          fileWriter.append(&quot;**********************************************************\n&quot;);</b>
<b class="fc">&nbsp;            fileWriter.flush();</b>
<b class="fc">&nbsp;        } catch (IOException e) {</b>
<b class="fc">&nbsp;        }</b>
&nbsp;
&nbsp;
<b class="fc">&nbsp;        String dbHelperStr = &quot;&quot;;</b>
<b class="fc">&nbsp;        String tableHelperStr = &quot;&quot;;</b>
&nbsp;
<b class="fc">&nbsp;        if (connection instanceof WSConnection) {</b>
<b class="nc">&nbsp;            WSConnection wsConnection = (WSConnection) connection;</b>
&nbsp;            //BI模式，只查询用户表，只查表，不查询子表
<b class="nc">&nbsp;            if (wsConnection.getParam().getConnectMode() == 1){</b>
<b class="nc">&nbsp;                dbHelperStr = &quot; user &quot;;</b>
<b class="nc">&nbsp;                tableHelperStr = &quot; normal &quot;;</b>
&nbsp;
&nbsp;            }
&nbsp;        }
&nbsp;
<b class="fc">&nbsp;        if (!StringUtils.isEmpty(catalog) &amp;&amp; !isAvailableCatalog(connection, catalog)){</b>
<b class="nc">&nbsp;            return new EmptyResultSet();</b>
&nbsp;        }
&nbsp;
<b class="fc">&nbsp;        DatabaseMetaDataResultSet resultSet = new DatabaseMetaDataResultSet();</b>
&nbsp;        // set column metadata list
<b class="fc">&nbsp;        resultSet.setColumnMetaDataList(buildGetTablesColumnMetaDataList());</b>
&nbsp;        // set row data
<b class="fc">&nbsp;        List&lt;TSDBResultSetRowData&gt; rowDataList = new ArrayList&lt;&gt;();</b>
<b class="fc">&nbsp;        try (Statement stmt = connection.createStatement()) {</b>
<b class="fc">&nbsp;            List&lt;String&gt; dbs = new ArrayList&lt;&gt;();</b>
<b class="fc">&nbsp;            if (!StringUtils.isEmpty(catalog)) {</b>
<b class="fc">&nbsp;                dbs.add(catalog);</b>
&nbsp;            } else {
<b class="nc">&nbsp;                try (ResultSet dbRs = stmt.executeQuery(&quot;show &quot; + dbHelperStr + &quot; databases&quot;)) {</b>
<b class="nc">&nbsp;                    while (dbRs.next()) {</b>
<b class="nc">&nbsp;                        dbs.add(dbRs.getString(&quot;name&quot;));</b>
&nbsp;                    }
<b class="nc">&nbsp;                }</b>
&nbsp;            }
<b class="fc">&nbsp;            if (dbs.isEmpty()) {</b>
<b class="nc">&nbsp;                return new EmptyResultSet();</b>
&nbsp;            }
<b class="fc">&nbsp;            for (String db : dbs) {</b>
<b class="fc">&nbsp;                StringBuilder sql = new StringBuilder().append(&quot;show &quot; + tableHelperStr).append(db).append(&quot;.tables &quot;);</b>
<b class="fc">&nbsp;                StringBuilder Ssql = new StringBuilder().append(&quot;show &quot;).append(db).append(&quot;.stables &quot;);</b>
<b class="fc">&nbsp;                if (!StringUtils.isEmpty(tableNamePattern)) {</b>
<b class="nc">&nbsp;                    sql.append(&quot;like &#39;&quot;).append(tableNamePattern).append(&quot;&#39;&quot;);</b>
<b class="nc">&nbsp;                    Ssql.append(&quot;like &#39;&quot;).append(tableNamePattern).append(&quot;&#39;&quot;);</b>
&nbsp;                }
<b class="fc">&nbsp;                try (ResultSet tables = stmt.executeQuery(sql.toString())) {</b>
<b class="fc">&nbsp;                    while (tables.next()) {</b>
<b class="fc">&nbsp;                        TSDBResultSetRowData rowData = new TSDBResultSetRowData(10);</b>
<b class="fc">&nbsp;                        rowData.setStringValue(1, db);                                     //TABLE_CAT</b>
<b class="fc">&nbsp;                        rowData.setStringValue(2, null);                                 //TABLE_SCHEM</b>
<b class="fc">&nbsp;                        rowData.setStringValue(3, tables.getString(&quot;table_name&quot;));  //TABLE_NAME</b>
<b class="fc">&nbsp;                        rowData.setStringValue(4, &quot;TABLE&quot;);                              //TABLE_TYPE</b>
<b class="fc">&nbsp;                        rowData.setStringValue(5, &quot;&quot;);                                   //REMARKS</b>
<b class="fc">&nbsp;                        rowDataList.add(rowData);</b>
<b class="fc">&nbsp;                    }</b>
<b class="fc">&nbsp;                }</b>
<b class="fc">&nbsp;                try (ResultSet stables = stmt.executeQuery(Ssql.toString())) {</b>
<b class="fc">&nbsp;                    while (stables.next()) {</b>
<b class="fc">&nbsp;                        TSDBResultSetRowData rowData = new TSDBResultSetRowData(10);</b>
<b class="fc">&nbsp;                        rowData.setStringValue(1, db);                                  //TABLE_CAT</b>
<b class="fc">&nbsp;                        rowData.setStringValue(2, null);                              //TABLE_SCHEM</b>
<b class="fc">&nbsp;                        rowData.setStringValue(3, stables.getString(&quot;stable_name&quot;));    //TABLE_NAME</b>
<b class="fc">&nbsp;                        rowData.setStringValue(4, &quot;TABLE&quot;);                           //TABLE_TYPE</b>
<b class="fc">&nbsp;                        rowData.setStringValue(5, &quot;STABLE&quot;);                          //REMARKS</b>
<b class="fc">&nbsp;                        rowDataList.add(rowData);</b>
<b class="fc">&nbsp;                    }</b>
<b class="fc">&nbsp;                }</b>
<b class="fc">&nbsp;            }</b>
<b class="fc">&nbsp;            resultSet.setRowDataList(rowDataList);</b>
<b class="fc">&nbsp;        }</b>
<b class="fc">&nbsp;        return resultSet;</b>
&nbsp;    }
&nbsp;
&nbsp;    private ColumnMetaData buildTableTypeMeta(int colIndex) {
<b class="fc">&nbsp;        ColumnMetaData col4 = new ColumnMetaData();</b>
<b class="fc">&nbsp;        col4.setColIndex(colIndex);</b>
<b class="fc">&nbsp;        col4.setColName(&quot;TABLE_TYPE&quot;);</b>
<b class="fc">&nbsp;        col4.setColType(TSDBConstants.TSDB_DATA_TYPE_NCHAR);</b>
<b class="fc">&nbsp;        return col4;</b>
&nbsp;    }
&nbsp;
&nbsp;    public ResultSet getSchemas() {
<b class="fc">&nbsp;        return getEmptyResultSet();</b>
&nbsp;    }
&nbsp;
&nbsp;    public abstract ResultSet getCatalogs() throws SQLException;
&nbsp;
&nbsp;    private List&lt;ColumnMetaData&gt; buildTableTypesColumnMetadataList() {
<b class="fc">&nbsp;        List&lt;ColumnMetaData&gt; columnMetaDataList = new ArrayList&lt;&gt;();</b>
<b class="fc">&nbsp;        columnMetaDataList.add(buildTableTypeMeta(1));</b>
<b class="fc">&nbsp;        return columnMetaDataList;</b>
&nbsp;    }
&nbsp;
&nbsp;    public ResultSet getTableTypes() throws SQLException {
<b class="fc">&nbsp;        DatabaseMetaDataResultSet resultSet = new DatabaseMetaDataResultSet();</b>
&nbsp;        // set up ColumnMetaDataList
<b class="fc">&nbsp;        resultSet.setColumnMetaDataList(buildTableTypesColumnMetadataList());</b>
&nbsp;
&nbsp;        // set up rowDataList
<b class="fc">&nbsp;        List&lt;TSDBResultSetRowData&gt; rowDataList = new ArrayList&lt;&gt;();</b>
<b class="fc">&nbsp;        TSDBResultSetRowData rowData = new TSDBResultSetRowData(1);</b>
<b class="fc">&nbsp;        rowData.setStringValue(1, &quot;TABLE&quot;);</b>
<b class="fc">&nbsp;        rowDataList.add(rowData);</b>
<b class="fc">&nbsp;        rowData = new TSDBResultSetRowData(1);</b>
<b class="fc">&nbsp;        rowData.setStringValue(1, &quot;STABLE&quot;);</b>
<b class="fc">&nbsp;        rowDataList.add(rowData);</b>
<b class="fc">&nbsp;        resultSet.setRowDataList(rowDataList);</b>
&nbsp;
<b class="fc">&nbsp;        return resultSet;</b>
&nbsp;    }
&nbsp;
&nbsp;    public abstract ResultSet getColumns(String catalog, String schemaPattern, String tableNamePattern, String columnNamePattern) throws SQLException;
&nbsp;
&nbsp;    private Map&lt;String, String&gt; getCatalogMate(Connection connection, String catalog) throws SQLException {
<b class="fc">&nbsp;        Map&lt;String, String&gt; result = new HashMap&lt;&gt;();</b>
<b class="fc">&nbsp;        try (Statement stmt = connection.createStatement();</b>
<b class="fc">&nbsp;             ResultSet databases = stmt.executeQuery(&quot;select name, `precision` as `precision` from information_schema.ins_databases&quot;)) {</b>
<b class="fc">&nbsp;            while (databases.next()) {</b>
<b class="fc">&nbsp;                String dbname = databases.getString(&quot;name&quot;);</b>
<b class="fc">&nbsp;                String precision = databases.getString(&quot;precision&quot;);</b>
<b class="fc">&nbsp;                if (catalog == null) {</b>
<b class="fc">&nbsp;                    result.put(dbname, precision);</b>
&nbsp;                } else {
<b class="fc">&nbsp;                    if (dbname.equalsIgnoreCase(catalog))</b>
<b class="fc">&nbsp;                        result.put(dbname, precision);</b>
&nbsp;                }
<b class="fc">&nbsp;            }</b>
<b class="fc">&nbsp;        }</b>
<b class="fc">&nbsp;        return result;</b>
&nbsp;    }
&nbsp;
&nbsp;    // database - stables
&nbsp;    private Map&lt;String, Set&lt;String&gt;&gt; getSTableMate(Connection connection, String sTable, String db) throws SQLException {
<b class="fc">&nbsp;        Map&lt;String, Set&lt;String&gt;&gt; result = new HashMap&lt;&gt;();</b>
<b class="fc">&nbsp;        String sql = &quot;select stable_name, db_name from information_schema.ins_stables where 1 = 1 &quot;;</b>
<b class="fc">&nbsp;        if (sTable != null)</b>
<b class="fc">&nbsp;            sql += &quot; and stable_name=&#39;&quot; + sTable + &quot;&#39;&quot;;</b>
<b class="fc">&nbsp;        if (db != null)</b>
<b class="fc">&nbsp;            sql += &quot; and db_name= &#39;&quot; + db + &quot;&#39;&quot;;</b>
<b class="fc">&nbsp;        try (Statement stmt = connection.createStatement();</b>
<b class="fc">&nbsp;             ResultSet databases = stmt.executeQuery(sql)) {</b>
<b class="fc">&nbsp;            while (databases.next()) {</b>
<b class="fc">&nbsp;                String name = databases.getString(&quot;stable_name&quot;);</b>
<b class="fc">&nbsp;                String dbName = databases.getString(&quot;db_name&quot;);</b>
&nbsp;                Set&lt;String&gt; stables;
<b class="fc">&nbsp;                if (result.containsKey(dbName)) {</b>
<b class="nc">&nbsp;                    stables = result.get(dbName);</b>
&nbsp;                } else {
<b class="fc">&nbsp;                    stables = new HashSet&lt;&gt;();</b>
<b class="fc">&nbsp;                    result.put(dbName, stables);</b>
&nbsp;                }
<b class="fc">&nbsp;                stables.add(name);</b>
<b class="fc">&nbsp;            }</b>
<b class="fc">&nbsp;        }</b>
<b class="fc">&nbsp;        return result;</b>
&nbsp;    }
&nbsp;
&nbsp;    private Map&lt;String, Set&lt;String&gt;&gt; getTableMate(Connection connection, String table, String db) throws SQLException {
<b class="fc">&nbsp;        Map&lt;String, Set&lt;String&gt;&gt; result = new HashMap&lt;&gt;();</b>
<b class="fc">&nbsp;        String sql = &quot;select table_name, db_name, stable_name from information_schema.ins_tables where 1 = 1 &quot;;</b>
<b class="fc">&nbsp;        if (table != null)</b>
<b class="fc">&nbsp;            sql += &quot; and table_name=&#39;&quot; + table + &quot;&#39;&quot;;</b>
<b class="fc">&nbsp;        if (db != null)</b>
<b class="fc">&nbsp;            sql += &quot; and db_name=&#39;&quot; + db + &quot;&#39;&quot;;</b>
<b class="fc">&nbsp;        try (Statement stmt = connection.createStatement();</b>
<b class="fc">&nbsp;             ResultSet tables = stmt.executeQuery(sql)) {</b>
<b class="fc">&nbsp;            while (tables.next()) {</b>
<b class="fc">&nbsp;                String name = tables.getString(&quot;table_name&quot;);</b>
<b class="fc">&nbsp;                String dbName = tables.getString(&quot;db_name&quot;);</b>
<b class="fc">&nbsp;                if (result.containsKey(dbName)) {</b>
<b class="nc">&nbsp;                    Set&lt;String&gt; set = result.get(dbName);</b>
<b class="nc">&nbsp;                    set.add(name);</b>
<b class="nc">&nbsp;                } else {</b>
<b class="fc">&nbsp;                    Set&lt;String&gt; set = new HashSet&lt;&gt;();</b>
<b class="fc">&nbsp;                    set.add(name);</b>
<b class="fc">&nbsp;                    result.put(dbName, set);</b>
&nbsp;                }
<b class="fc">&nbsp;            }</b>
<b class="fc">&nbsp;        }</b>
<b class="fc">&nbsp;        return result;</b>
&nbsp;    }
&nbsp;
&nbsp;    // super table
&nbsp;    private void show2RowData(ResultSet rs, List&lt;TSDBResultSetRowData&gt; rowDataList, String precision, String db, String tableName, String colName) throws SQLException {
<b class="fc">&nbsp;        int rowIndex = 0;</b>
<b class="fc">&nbsp;        while (rs.next()) {</b>
&nbsp;//            table_name, db_name, table_type, col_name as field, col_type as type, col_length as length
<b class="fc">&nbsp;            TSDBResultSetRowData rowData = new TSDBResultSetRowData(24);</b>
&nbsp;            // set TABLE_CAT
<b class="fc">&nbsp;            rowData.setStringValue(1, db);</b>
&nbsp;            // set TABLE_SCHEM
<b class="fc">&nbsp;            rowData.setStringValue(2, null);</b>
&nbsp;            // set TABLE_NAME
<b class="fc">&nbsp;            rowData.setStringValue(3, tableName);</b>
&nbsp;            // set COLUMN_NAME
<b class="fc">&nbsp;            String field = rs.getString(&quot;field&quot;);</b>
<b class="fc">&nbsp;            if (colName == null || colName.equals(&quot;%&quot;) || colName.equals(field)) {</b>
<b class="fc">&nbsp;                rowData.setStringValue(4, field);</b>
&nbsp;            } else {
&nbsp;                continue;
&nbsp;            }
&nbsp;            // set DATA_TYPE
<b class="fc">&nbsp;            String typeName = rs.getString(&quot;type&quot;);</b>
<b class="fc">&nbsp;            rowData.setIntValue(5, DataType.getDataType(typeName).getJdbcTypeValue());</b>
&nbsp;            // set TYPE_NAME
<b class="fc">&nbsp;            rowData.setStringValue(6, typeName);</b>
&nbsp;            // set COLUMN_SIZE
<b class="fc">&nbsp;            int length = rs.getInt(&quot;length&quot;);</b>
<b class="fc">&nbsp;            int size = DataType.calculateColumnSize(typeName, precision, length);</b>
<b class="fc">&nbsp;            if (size != -1) {</b>
<b class="fc">&nbsp;                rowData.setIntValue(7, size);</b>
&nbsp;            } else {
<b class="nc">&nbsp;                rowData.setString(7, null);</b>
&nbsp;            }
&nbsp;            // set BUFFER LENGTH
<b class="fc">&nbsp;            rowData.setStringValue(8, null);</b>
&nbsp;            // set DECIMAL_DIGITS
<b class="fc">&nbsp;            Integer decimalDigits = DataType.calculateDecimalDigits(typeName);</b>
<b class="fc">&nbsp;            if (decimalDigits != null) {</b>
<b class="fc">&nbsp;                rowData.setIntValue(9, decimalDigits);</b>
&nbsp;            } else {
<b class="fc">&nbsp;                rowData.setStringValue(9, null);</b>
&nbsp;            }
&nbsp;            // set NUM_PREC_RADIX
<b class="fc">&nbsp;            rowData.setIntValue(10, 10);</b>
&nbsp;            // set NULLABLE
<b class="fc">&nbsp;            rowData.setIntValue(11, isNullable(rowIndex, typeName));</b>
&nbsp;            // set REMARKS
<b class="fc">&nbsp;            String note = rs.getString(&quot;note&quot;);</b>
<b class="fc">&nbsp;            rowData.setStringValue(12, note.trim().isEmpty() ? null : note);</b>
<b class="fc">&nbsp;            rowDataList.add(rowData);</b>
<b class="fc">&nbsp;            rowIndex++;</b>
<b class="fc">&nbsp;        }</b>
&nbsp;    }
&nbsp;
<b class="fc">&nbsp;    Pattern pattern = Pattern.compile(&quot;\\((\\d+)\\)&quot;);</b>
&nbsp;    // normal table or child table
&nbsp;    private void colResultSet2RowData(ResultSet rs, List&lt;TSDBResultSetRowData&gt; rowDataList, Map&lt;String, String&gt; precision) throws SQLException {
<b class="fc">&nbsp;        int rowIndex = 0;</b>
<b class="fc">&nbsp;        while (rs.next()) {</b>
&nbsp;//            table_name, db_name, table_type, col_name as field, col_type as type, col_length as length
<b class="fc">&nbsp;            TSDBResultSetRowData rowData = new TSDBResultSetRowData(24);</b>
&nbsp;            // set TABLE_CAT
<b class="fc">&nbsp;            String db = rs.getString(&quot;db_name&quot;);</b>
<b class="fc">&nbsp;            rowData.setStringValue(1, db);</b>
&nbsp;            // set TABLE_SCHEM
<b class="fc">&nbsp;            rowData.setStringValue(2, null);</b>
&nbsp;            // set TABLE_NAME
<b class="fc">&nbsp;            String tableName = rs.getString(&quot;table_name&quot;);</b>
<b class="fc">&nbsp;            rowData.setStringValue(3, tableName);</b>
&nbsp;            // set COLUMN_NAME
<b class="fc">&nbsp;            rowData.setStringValue(4, rs.getString(&quot;col_name&quot;));</b>
&nbsp;            // set DATA_TYPE
<b class="fc">&nbsp;            String typeName = rs.getString(&quot;col_type&quot;);</b>
<b class="fc">&nbsp;            int length = 0;</b>
<b class="fc">&nbsp;            if (typeName.startsWith(&quot;VARCHAR&quot;)) {</b>
<b class="fc">&nbsp;                rowData.setIntValue(5, DataType.getDataType(&quot;VARCHAR&quot;).getJdbcTypeValue());</b>
<b class="fc">&nbsp;                length = rs.getInt(&quot;col_length&quot;) - 2;</b>
<b class="fc">&nbsp;                typeName = &quot;VARCHAR&quot;;</b>
<b class="fc">&nbsp;            } else if (typeName.startsWith(&quot;NCHAR&quot;)) {</b>
<b class="fc">&nbsp;                rowData.setIntValue(5, DataType.getDataType(&quot;NCHAR&quot;).getJdbcTypeValue());</b>
<b class="fc">&nbsp;                Matcher matcher = pattern.matcher(typeName);</b>
<b class="fc">&nbsp;                if (matcher.find()) {</b>
<b class="fc">&nbsp;                    length = Integer.parseInt(matcher.group(1));</b>
&nbsp;                }
<b class="fc">&nbsp;                typeName = &quot;NCHAR&quot;;</b>
<b class="fc">&nbsp;            } else {</b>
<b class="fc">&nbsp;                rowData.setIntValue(5, DataType.getDataType(typeName).getJdbcTypeValue());</b>
<b class="fc">&nbsp;                length = rs.getInt(&quot;col_length&quot;);</b>
&nbsp;            }
&nbsp;            // set TYPE_NAME
<b class="fc">&nbsp;            rowData.setStringValue(6, typeName);</b>
&nbsp;            // set COLUMN_SIZE
<b class="fc">&nbsp;            String p = precision.get(db);</b>
<b class="fc">&nbsp;            int size = DataType.calculateColumnSize(typeName, p, length);</b>
<b class="fc">&nbsp;            if (size != -1) {</b>
<b class="fc">&nbsp;                rowData.setIntValue(7, size);</b>
&nbsp;            } else {
<b class="nc">&nbsp;                rowData.setString(7, null);</b>
&nbsp;            }
&nbsp;            // set BUFFER LENGTH
<b class="fc">&nbsp;            rowData.setStringValue(8, null);</b>
&nbsp;            // set DECIMAL_DIGITS
<b class="fc">&nbsp;            Integer decimalDigits = DataType.calculateDecimalDigits(typeName);</b>
<b class="fc">&nbsp;            if (decimalDigits != null) {</b>
<b class="fc">&nbsp;                rowData.setIntValue(9, decimalDigits);</b>
&nbsp;            } else {
<b class="fc">&nbsp;                rowData.setStringValue(9, null);</b>
&nbsp;            }
&nbsp;            // set NUM_PREC_RADIX
<b class="fc">&nbsp;            rowData.setIntValue(10, 10);</b>
&nbsp;            // set NULLABLE
<b class="fc">&nbsp;            rowData.setIntValue(11, isNullable(rowIndex, typeName));</b>
&nbsp;            // set REMARKS
<b class="fc">&nbsp;            rowData.setStringValue(12, null);</b>
<b class="fc">&nbsp;            rowDataList.add(rowData);</b>
<b class="fc">&nbsp;            rowIndex++;</b>
<b class="fc">&nbsp;        }</b>
&nbsp;    }
&nbsp;
&nbsp;    // child table
&nbsp;    private void tagResultSet2RowData(ResultSet rs, List&lt;TSDBResultSetRowData&gt; rowDataList, Map&lt;String, String&gt; precision) throws SQLException {
<b class="fc">&nbsp;        int rowIndex = 0;</b>
<b class="fc">&nbsp;        while (rs.next()) {</b>
<b class="fc">&nbsp;            TSDBResultSetRowData rowData = new TSDBResultSetRowData(24);</b>
&nbsp;            // set TABLE_CAT
<b class="fc">&nbsp;            String db = rs.getString(&quot;db_name&quot;);</b>
<b class="fc">&nbsp;            rowData.setStringValue(1, db);</b>
&nbsp;            // set TABLE_SCHEM
<b class="fc">&nbsp;            rowData.setStringValue(2, null);</b>
&nbsp;            // set TABLE_NAME
<b class="fc">&nbsp;            rowData.setStringValue(3, rs.getString(&quot;table_name&quot;));</b>
&nbsp;            // set COLUMN_NAME
<b class="fc">&nbsp;            rowData.setStringValue(4, rs.getString(&quot;tag_name&quot;));</b>
&nbsp;            // set DATA_TYPE
<b class="fc">&nbsp;            String typeName = rs.getString(&quot;tag_type&quot;);</b>
<b class="fc">&nbsp;            int length = 0;</b>
<b class="fc">&nbsp;            if (typeName.startsWith(&quot;VARCHAR&quot;)) {</b>
<b class="nc">&nbsp;                rowData.setIntValue(5, DataType.getDataType(&quot;VARCHAR&quot;).getJdbcTypeValue());</b>
<b class="nc">&nbsp;                Matcher matcher = pattern.matcher(typeName);</b>
<b class="nc">&nbsp;                if (matcher.find()) {</b>
<b class="nc">&nbsp;                    length = Integer.parseInt(matcher.group(1));</b>
&nbsp;                }
<b class="nc">&nbsp;                typeName = &quot;VARCHAR&quot;;</b>
<b class="nc">&nbsp;            } else if (typeName.startsWith(&quot;NCHAR&quot;)) {</b>
<b class="nc">&nbsp;                rowData.setIntValue(5, DataType.getDataType(&quot;NCHAR&quot;).getJdbcTypeValue());</b>
<b class="nc">&nbsp;                Matcher matcher = pattern.matcher(typeName);</b>
<b class="nc">&nbsp;                if (matcher.find()) {</b>
<b class="nc">&nbsp;                    length = Integer.parseInt(matcher.group(1));</b>
&nbsp;                }
<b class="nc">&nbsp;                typeName = &quot;NCHAR&quot;;</b>
<b class="nc">&nbsp;            }else {</b>
<b class="fc">&nbsp;                rowData.setIntValue(5, DataType.getDataType(typeName).getJdbcTypeValue());</b>
<b class="fc">&nbsp;                length = 0;</b>
&nbsp;            }
&nbsp;            // set TYPE_NAME
<b class="fc">&nbsp;            rowData.setStringValue(6, typeName);</b>
&nbsp;            // set COLUMN_SIZE
<b class="fc">&nbsp;            String p = precision.get(db);</b>
<b class="fc">&nbsp;            int size = DataType.calculateColumnSize(typeName, p, length);</b>
<b class="fc">&nbsp;            if (size != -1) {</b>
<b class="fc">&nbsp;                rowData.setIntValue(7, size);</b>
&nbsp;            } else {
<b class="nc">&nbsp;                rowData.setString(7, null);</b>
&nbsp;            }
&nbsp;            // set BUFFER LENGTH
<b class="fc">&nbsp;            rowData.setStringValue(8, null);</b>
&nbsp;            // set DECIMAL_DIGITS
<b class="fc">&nbsp;            Integer decimalDigits = DataType.calculateDecimalDigits(typeName);</b>
<b class="fc">&nbsp;            if (decimalDigits != null) {</b>
<b class="fc">&nbsp;                rowData.setIntValue(9, decimalDigits);</b>
&nbsp;            } else {
<b class="nc">&nbsp;                rowData.setStringValue(9, null);</b>
&nbsp;            }
&nbsp;            // set NUM_PREC_RADIX
<b class="fc">&nbsp;            rowData.setIntValue(10, 10);</b>
&nbsp;            // set NULLABLE
<b class="fc">&nbsp;            rowData.setIntValue(11, isNullable(rowIndex, typeName));</b>
&nbsp;            // set REMARKS
<b class="fc">&nbsp;            rowData.setStringValue(12, null);</b>
<b class="fc">&nbsp;            rowDataList.add(rowData);</b>
<b class="fc">&nbsp;            rowIndex++;</b>
<b class="fc">&nbsp;        }</b>
&nbsp;    }
&nbsp;
&nbsp;    protected ResultSet getColumns(String catalog, String schemaPattern, String tableNamePattern, String columnNamePattern, Connection conn) throws SQLException {
<b class="fc">&nbsp;        DatabaseMetaDataResultSet resultSet = new DatabaseMetaDataResultSet();</b>
&nbsp;        // set up ColumnMetaDataList
<b class="fc">&nbsp;        resultSet.setColumnMetaDataList(buildGetColumnsColumnMetaDataList());</b>
&nbsp;        // set up rowDataList
<b class="fc">&nbsp;        List&lt;TSDBResultSetRowData&gt; rowDataList = new ArrayList&lt;&gt;();</b>
&nbsp;
<b class="fc">&nbsp;        if (catalog == null || catalog.equals(&quot;%&quot;)) {</b>
<b class="fc">&nbsp;            Map&lt;String, String&gt; precisions = getCatalogMate(conn, null);</b>
<b class="fc">&nbsp;            if (tableNamePattern == null || tableNamePattern.equals(&quot;%&quot;)) {</b>
<b class="fc">&nbsp;                if (columnNamePattern == null || columnNamePattern.equals(&quot;%&quot;)) {</b>
<b class="fc">&nbsp;                    Map&lt;String, Set&lt;String&gt;&gt; sTableMate = getSTableMate(conn, null, null);</b>
<b class="fc">&nbsp;                    for (String db : sTableMate.keySet()) {</b>
<b class="fc">&nbsp;                        for (String s : sTableMate.get(db)) {</b>
<b class="fc">&nbsp;                            try (Statement stmt = conn.createStatement();</b>
<b class="fc">&nbsp;                                 ResultSet rs = stmt.executeQuery(&quot;describe &quot; + db + &quot;.&quot; + s)) {</b>
<b class="fc">&nbsp;                                show2RowData(rs, rowDataList, precisions.get(db), db, s, null);</b>
<b class="fc">&nbsp;                            }</b>
<b class="fc">&nbsp;                        }</b>
<b class="fc">&nbsp;                    }</b>
&nbsp;
<b class="fc">&nbsp;                    try (Statement stmt = conn.createStatement();</b>
<b class="fc">&nbsp;                         ResultSet rs = stmt.executeQuery(</b>
&nbsp;                                 &quot;select table_name, db_name, table_type, col_name, col_type, col_length &quot; +
&nbsp;                                         &quot;from information_schema.ins_columns&quot;)) {
<b class="fc">&nbsp;                        colResultSet2RowData(rs, rowDataList, precisions);</b>
<b class="fc">&nbsp;                    }</b>
&nbsp;
<b class="fc">&nbsp;                    try (Statement stmt = conn.createStatement();</b>
<b class="fc">&nbsp;                         ResultSet rs = stmt.executeQuery(</b>
&nbsp;                                 &quot;select table_name, db_name, stable_name, tag_name, tag_type &quot; +
&nbsp;                                         &quot;from information_schema.ins_tags&quot;)) {
<b class="fc">&nbsp;                        tagResultSet2RowData(rs, rowDataList, precisions);</b>
<b class="fc">&nbsp;                    }</b>
<b class="fc">&nbsp;                } else {</b>
<b class="fc">&nbsp;                    try (Statement stmt = conn.createStatement();</b>
<b class="fc">&nbsp;                         ResultSet rs = stmt.executeQuery(</b>
&nbsp;                                 &quot;select table_name, db_name, table_type, col_name, col_type, col_length &quot; +
&nbsp;                                         &quot;from information_schema.ins_columns where col_name = &#39;&quot; + columnNamePattern + &quot;&#39;&quot;)) {
<b class="fc">&nbsp;                        colResultSet2RowData(rs, rowDataList, precisions);</b>
<b class="fc">&nbsp;                    }</b>
&nbsp;                    // stable tag not found
<b class="fc">&nbsp;                    try (Statement stmt = conn.createStatement();</b>
<b class="fc">&nbsp;                         ResultSet rs = stmt.executeQuery(</b>
&nbsp;                                 &quot;select table_name, db_name, stable_name, tag_name, tag_type &quot; +
&nbsp;                                         &quot;from information_schema.ins_tags where tag_name = &#39;&quot; + columnNamePattern + &quot;&#39;&quot;)) {
<b class="fc">&nbsp;                        tagResultSet2RowData(rs, rowDataList, precisions);</b>
<b class="fc">&nbsp;                    }</b>
&nbsp;                }
&nbsp;            } else {
<b class="fc">&nbsp;                Map&lt;String, Set&lt;String&gt;&gt; sTableMate = getSTableMate(conn, tableNamePattern, null);</b>
<b class="fc">&nbsp;                for (String db : sTableMate.keySet()) {</b>
<b class="nc">&nbsp;                    for (String s : sTableMate.get(db)) {</b>
<b class="nc">&nbsp;                        try (Statement stmt = conn.createStatement();</b>
<b class="nc">&nbsp;                             ResultSet rs = stmt.executeQuery(&quot;describe &quot; + db + &quot;.&quot; + s)) {</b>
<b class="nc">&nbsp;                            show2RowData(rs, rowDataList, precisions.get(db), db, s, columnNamePattern);</b>
<b class="nc">&nbsp;                        }</b>
<b class="nc">&nbsp;                    }</b>
<b class="nc">&nbsp;                }</b>
<b class="fc">&nbsp;                Map&lt;String, Set&lt;String&gt;&gt; tableMate = getTableMate(conn, tableNamePattern, null);</b>
<b class="fc">&nbsp;                for (Map.Entry&lt;String, Set&lt;String&gt;&gt; dbs : tableMate.entrySet()) {</b>
<b class="fc">&nbsp;                    for (String table : dbs.getValue()) {</b>
<b class="fc">&nbsp;                        try (Statement stmt = conn.createStatement();</b>
<b class="fc">&nbsp;                             ResultSet rs = stmt.executeQuery(&quot;describe &quot; + dbs.getKey() + &quot;.&quot; + table)) {</b>
<b class="fc">&nbsp;                            show2RowData(rs, rowDataList, precisions.get(dbs.getKey()), dbs.getKey(), table, columnNamePattern);</b>
<b class="fc">&nbsp;                        }</b>
<b class="fc">&nbsp;                    }</b>
<b class="fc">&nbsp;                }</b>
&nbsp;            }
<b class="fc">&nbsp;        } else {</b>
<b class="fc">&nbsp;            if (catalog.isEmpty())</b>
<b class="nc">&nbsp;                return new EmptyResultSet();</b>
<b class="fc">&nbsp;            Map&lt;String, String&gt; precisions = getCatalogMate(conn, catalog);</b>
<b class="fc">&nbsp;            if (precisions.get(catalog) == null)</b>
<b class="nc">&nbsp;                return new EmptyResultSet();</b>
<b class="fc">&nbsp;            if (tableNamePattern == null || tableNamePattern.equals(&quot;%&quot;)) {</b>
<b class="nc">&nbsp;                if (columnNamePattern == null || columnNamePattern.equals(&quot;%&quot;)) {</b>
<b class="nc">&nbsp;                    Map&lt;String, Set&lt;String&gt;&gt; stableMate = getSTableMate(conn, null, catalog);</b>
<b class="nc">&nbsp;                    for (String db : stableMate.keySet()) {</b>
<b class="nc">&nbsp;                        for (String s : stableMate.get(db)) {</b>
<b class="nc">&nbsp;                            try (Statement stmt = conn.createStatement();</b>
<b class="nc">&nbsp;                                 ResultSet rs = stmt.executeQuery(&quot;describe &quot; + catalog + &quot;.&quot; + s)) {</b>
<b class="nc">&nbsp;                                show2RowData(rs, rowDataList, precisions.get(catalog), catalog, s, null);</b>
<b class="nc">&nbsp;                            }</b>
<b class="nc">&nbsp;                        }</b>
<b class="nc">&nbsp;                    }</b>
&nbsp;
<b class="nc">&nbsp;                    try (Statement stmt = conn.createStatement();</b>
<b class="nc">&nbsp;                         ResultSet rs = stmt.executeQuery(</b>
&nbsp;                                 &quot;select table_name, db_name, table_type, col_name, col_type, col_length &quot; +
&nbsp;                                         &quot;from information_schema.ins_columns where db_name = &#39;&quot; + catalog + &quot;&#39;&quot;)) {
<b class="nc">&nbsp;                        colResultSet2RowData(rs, rowDataList, precisions);</b>
<b class="nc">&nbsp;                    }</b>
&nbsp;
<b class="nc">&nbsp;                    try (Statement stmt = conn.createStatement();</b>
<b class="nc">&nbsp;                         ResultSet rs = stmt.executeQuery(</b>
&nbsp;                                 &quot;select table_name, db_name, stable_name, tag_name, tag_type &quot; +
&nbsp;                                         &quot;from information_schema.ins_tags where db_name = &#39;&quot; + catalog + &quot;&#39;&quot;)) {
<b class="nc">&nbsp;                        tagResultSet2RowData(rs, rowDataList, precisions);</b>
<b class="nc">&nbsp;                    }</b>
<b class="nc">&nbsp;                } else {</b>
<b class="nc">&nbsp;                    try (Statement stmt = conn.createStatement();</b>
<b class="nc">&nbsp;                         ResultSet rs = stmt.executeQuery(</b>
&nbsp;                                 &quot;select table_name, db_name, table_type, col_name, col_type, col_length &quot; +
&nbsp;                                         &quot;from information_schema.ins_columns where col_name = &#39;&quot; + columnNamePattern + &quot;&#39; and db_name = &#39;&quot; + catalog + &quot;&#39;&quot;)) {
<b class="nc">&nbsp;                        colResultSet2RowData(rs, rowDataList, precisions);</b>
<b class="nc">&nbsp;                    }</b>
&nbsp;
&nbsp;                    // stable tag no found in result
<b class="nc">&nbsp;                    try (Statement stmt = conn.createStatement();</b>
<b class="nc">&nbsp;                         ResultSet rs = stmt.executeQuery(</b>
&nbsp;                                 &quot;select table_name, db_name, stable_name, tag_name, tag_type &quot; +
&nbsp;                                         &quot;from information_schema.ins_tags where tag_name = &#39;&quot; + columnNamePattern + &quot;&#39; and db_name = &#39;&quot; + catalog + &quot;&#39;&quot;)) {
<b class="nc">&nbsp;                        tagResultSet2RowData(rs, rowDataList, precisions);</b>
<b class="nc">&nbsp;                    }</b>
&nbsp;                }
&nbsp;            } else {
<b class="fc">&nbsp;                Map&lt;String, Set&lt;String&gt;&gt; sTableMate = getSTableMate(conn, tableNamePattern, catalog);</b>
<b class="fc">&nbsp;                for (String db : sTableMate.keySet()) {</b>
<b class="fc">&nbsp;                    for (String s : sTableMate.get(db)) {</b>
<b class="fc">&nbsp;                        try (Statement stmt = conn.createStatement();</b>
<b class="fc">&nbsp;                             ResultSet rs = stmt.executeQuery(&quot;describe &quot; + catalog + &quot;.&quot; + s)) {</b>
<b class="fc">&nbsp;                            show2RowData(rs, rowDataList, precisions.get(catalog), catalog, s, columnNamePattern);</b>
<b class="fc">&nbsp;                        }</b>
<b class="fc">&nbsp;                    }</b>
<b class="fc">&nbsp;                }</b>
&nbsp;
<b class="fc">&nbsp;                Map&lt;String, Set&lt;String&gt;&gt; tableMate = getTableMate(conn, tableNamePattern, catalog);</b>
<b class="fc">&nbsp;                for (Map.Entry&lt;String, Set&lt;String&gt;&gt; dbs : tableMate.entrySet()) {</b>
<b class="fc">&nbsp;                    for (String table : dbs.getValue()) {</b>
<b class="fc">&nbsp;                        try (Statement stmt = conn.createStatement();</b>
<b class="fc">&nbsp;                             ResultSet rs = stmt.executeQuery(&quot;describe &quot; + catalog + &quot;.&quot; + table)) {</b>
<b class="fc">&nbsp;                            show2RowData(rs, rowDataList, precisions.get(catalog), catalog, table, columnNamePattern);</b>
<b class="fc">&nbsp;                        }</b>
<b class="fc">&nbsp;                    }</b>
<b class="fc">&nbsp;                }</b>
&nbsp;            }
&nbsp;        }
<b class="fc">&nbsp;        resultSet.setRowDataList(rowDataList);</b>
<b class="fc">&nbsp;        return resultSet;</b>
&nbsp;    }
&nbsp;
&nbsp;    private int isNullable(int index, String typeName) {
<b class="fc">&nbsp;        if (index == 0 &amp;&amp; &quot;TIMESTAMP&quot;.equals(typeName))</b>
<b class="fc">&nbsp;            return DatabaseMetaData.columnNoNulls;</b>
<b class="fc">&nbsp;        return DatabaseMetaData.columnNullable;</b>
&nbsp;    }
&nbsp;
&nbsp;    private ColumnMetaData buildTableCatalogMeta(int colIndex) {
<b class="fc">&nbsp;        ColumnMetaData col1 = new ColumnMetaData();</b>
<b class="fc">&nbsp;        col1.setColIndex(colIndex);</b>
<b class="fc">&nbsp;        col1.setColName(&quot;TABLE_CAT&quot;);</b>
<b class="fc">&nbsp;        col1.setColType(TSDBConstants.TSDB_DATA_TYPE_NCHAR);</b>
<b class="fc">&nbsp;        return col1;</b>
&nbsp;    }
&nbsp;
&nbsp;    private ColumnMetaData buildTableSchemaMeta(int colIndex) {
<b class="fc">&nbsp;        ColumnMetaData col2 = new ColumnMetaData();</b>
<b class="fc">&nbsp;        col2.setColIndex(colIndex);</b>
<b class="fc">&nbsp;        col2.setColName(&quot;TABLE_SCHEM&quot;);</b>
<b class="fc">&nbsp;        col2.setColType(TSDBConstants.TSDB_DATA_TYPE_NCHAR);</b>
<b class="fc">&nbsp;        return col2;</b>
&nbsp;    }
&nbsp;
&nbsp;    private ColumnMetaData buildTableNameMeta(int colIndex) {
<b class="fc">&nbsp;        ColumnMetaData col3 = new ColumnMetaData();</b>
<b class="fc">&nbsp;        col3.setColIndex(colIndex);</b>
<b class="fc">&nbsp;        col3.setColName(&quot;TABLE_NAME&quot;);</b>
<b class="fc">&nbsp;        col3.setColSize(193);</b>
<b class="fc">&nbsp;        col3.setColType(TSDBConstants.TSDB_DATA_TYPE_NCHAR);</b>
<b class="fc">&nbsp;        return col3;</b>
&nbsp;    }
&nbsp;
&nbsp;    private ColumnMetaData buildColumnNameMeta(int colIndex) {
<b class="fc">&nbsp;        ColumnMetaData col4 = new ColumnMetaData();</b>
<b class="fc">&nbsp;        col4.setColIndex(colIndex);</b>
<b class="fc">&nbsp;        col4.setColName(&quot;COLUMN_NAME&quot;);</b>
<b class="fc">&nbsp;        col4.setColSize(65);</b>
<b class="fc">&nbsp;        col4.setColType(TSDBConstants.TSDB_DATA_TYPE_NCHAR);</b>
<b class="fc">&nbsp;        return col4;</b>
&nbsp;    }
&nbsp;
&nbsp;    private ColumnMetaData buildDataTypeMeta(int colIndex) {
<b class="fc">&nbsp;        ColumnMetaData col5 = new ColumnMetaData();</b>
<b class="fc">&nbsp;        col5.setColIndex(colIndex);</b>
<b class="fc">&nbsp;        col5.setColName(&quot;DATA_TYPE&quot;);</b>
<b class="fc">&nbsp;        col5.setColType(TSDBConstants.TSDB_DATA_TYPE_INT);</b>
<b class="fc">&nbsp;        return col5;</b>
&nbsp;    }
&nbsp;
&nbsp;    private ColumnMetaData buildColumnSizeMeta() {
<b class="fc">&nbsp;        ColumnMetaData col7 = new ColumnMetaData();</b>
<b class="fc">&nbsp;        col7.setColIndex(7);</b>
<b class="fc">&nbsp;        col7.setColName(&quot;COLUMN_SIZE&quot;);</b>
<b class="fc">&nbsp;        col7.setColType(TSDBConstants.TSDB_DATA_TYPE_INT);</b>
<b class="fc">&nbsp;        return col7;</b>
&nbsp;    }
&nbsp;
&nbsp;    private ColumnMetaData buildBufferLengthMeta() {
<b class="fc">&nbsp;        ColumnMetaData col8 = new ColumnMetaData();</b>
<b class="fc">&nbsp;        col8.setColIndex(8);</b>
<b class="fc">&nbsp;        col8.setColName(&quot;BUFFER_LENGTH&quot;);</b>
<b class="fc">&nbsp;        return col8;</b>
&nbsp;    }
&nbsp;
&nbsp;    private ColumnMetaData buildDecimalDigitsMeta() {
<b class="fc">&nbsp;        ColumnMetaData col9 = new ColumnMetaData();</b>
<b class="fc">&nbsp;        col9.setColIndex(9);</b>
<b class="fc">&nbsp;        col9.setColName(&quot;DECIMAL_DIGITS&quot;);</b>
<b class="fc">&nbsp;        col9.setColType(TSDBConstants.TSDB_DATA_TYPE_INT);</b>
<b class="fc">&nbsp;        return col9;</b>
&nbsp;    }
&nbsp;
&nbsp;    private ColumnMetaData buildNumPrecRadixMeta() {
<b class="fc">&nbsp;        ColumnMetaData col10 = new ColumnMetaData();</b>
<b class="fc">&nbsp;        col10.setColIndex(10);</b>
<b class="fc">&nbsp;        col10.setColName(&quot;NUM_PREC_RADIX&quot;);</b>
<b class="fc">&nbsp;        col10.setColType(TSDBConstants.TSDB_DATA_TYPE_INT);</b>
<b class="fc">&nbsp;        return col10;</b>
&nbsp;    }
&nbsp;
&nbsp;    private ColumnMetaData buildNullableMeta() {
<b class="fc">&nbsp;        ColumnMetaData col11 = new ColumnMetaData();</b>
<b class="fc">&nbsp;        col11.setColIndex(11);</b>
<b class="fc">&nbsp;        col11.setColName(&quot;NULLABLE&quot;);</b>
<b class="fc">&nbsp;        col11.setColType(TSDBConstants.TSDB_DATA_TYPE_INT);</b>
<b class="fc">&nbsp;        return col11;</b>
&nbsp;    }
&nbsp;
&nbsp;    private ColumnMetaData buildRemarksMeta(int colIndex) {
<b class="fc">&nbsp;        ColumnMetaData col12 = new ColumnMetaData();</b>
<b class="fc">&nbsp;        col12.setColIndex(colIndex);</b>
<b class="fc">&nbsp;        col12.setColName(&quot;REMARKS&quot;);</b>
<b class="fc">&nbsp;        col12.setColType(TSDBConstants.TSDB_DATA_TYPE_NCHAR);</b>
<b class="fc">&nbsp;        return col12;</b>
&nbsp;    }
&nbsp;
&nbsp;    private ColumnMetaData buildColumnDefMeta() {
<b class="fc">&nbsp;        ColumnMetaData col13 = new ColumnMetaData();</b>
<b class="fc">&nbsp;        col13.setColIndex(13);</b>
<b class="fc">&nbsp;        col13.setColName(&quot;COLUMN_DEF&quot;);</b>
<b class="fc">&nbsp;        col13.setColType(TSDBConstants.TSDB_DATA_TYPE_NCHAR);</b>
<b class="fc">&nbsp;        return col13;</b>
&nbsp;    }
&nbsp;
&nbsp;    private ColumnMetaData buildSqlDataTypeMeta() {
<b class="fc">&nbsp;        ColumnMetaData col14 = new ColumnMetaData();</b>
<b class="fc">&nbsp;        col14.setColIndex(14);</b>
<b class="fc">&nbsp;        col14.setColName(&quot;SQL_DATA_TYPE&quot;);</b>
<b class="fc">&nbsp;        col14.setColType(TSDBConstants.TSDB_DATA_TYPE_INT);</b>
<b class="fc">&nbsp;        return col14;</b>
&nbsp;    }
&nbsp;
&nbsp;    private ColumnMetaData buildSqlDatetimeSubMeta() {
<b class="fc">&nbsp;        ColumnMetaData col15 = new ColumnMetaData();</b>
<b class="fc">&nbsp;        col15.setColIndex(15);</b>
<b class="fc">&nbsp;        col15.setColName(&quot;SQL_DATETIME_SUB&quot;);</b>
<b class="fc">&nbsp;        col15.setColType(TSDBConstants.TSDB_DATA_TYPE_INT);</b>
<b class="fc">&nbsp;        return col15;</b>
&nbsp;    }
&nbsp;
&nbsp;    private ColumnMetaData buildCharOctetLengthMeta() {
<b class="fc">&nbsp;        ColumnMetaData col16 = new ColumnMetaData();</b>
<b class="fc">&nbsp;        col16.setColIndex(16);</b>
<b class="fc">&nbsp;        col16.setColName(&quot;CHAR_OCTET_LENGTH&quot;);</b>
<b class="fc">&nbsp;        col16.setColType(TSDBConstants.TSDB_DATA_TYPE_INT);</b>
<b class="fc">&nbsp;        return col16;</b>
&nbsp;    }
&nbsp;
&nbsp;    private ColumnMetaData buildOrdinalPositionMeta() {
<b class="fc">&nbsp;        ColumnMetaData col17 = new ColumnMetaData();</b>
<b class="fc">&nbsp;        col17.setColIndex(17);</b>
<b class="fc">&nbsp;        col17.setColName(&quot;ORDINAL_POSITION&quot;);</b>
<b class="fc">&nbsp;        col17.setColType(TSDBConstants.TSDB_DATA_TYPE_INT);</b>
<b class="fc">&nbsp;        return col17;</b>
&nbsp;    }
&nbsp;
&nbsp;    private ColumnMetaData buildIsNullableMeta() {
<b class="fc">&nbsp;        ColumnMetaData col18 = new ColumnMetaData();</b>
<b class="fc">&nbsp;        col18.setColIndex(18);</b>
<b class="fc">&nbsp;        col18.setColName(&quot;IS_NULLABLE&quot;);</b>
<b class="fc">&nbsp;        col18.setColType(TSDBConstants.TSDB_DATA_TYPE_NCHAR);</b>
<b class="fc">&nbsp;        return col18;</b>
&nbsp;    }
&nbsp;
&nbsp;    private ColumnMetaData buildScopeCatalogMeta() {
<b class="fc">&nbsp;        ColumnMetaData col19 = new ColumnMetaData();</b>
<b class="fc">&nbsp;        col19.setColIndex(19);</b>
<b class="fc">&nbsp;        col19.setColName(&quot;SCOPE_CATALOG&quot;);</b>
<b class="fc">&nbsp;        col19.setColType(TSDBConstants.TSDB_DATA_TYPE_NCHAR);</b>
<b class="fc">&nbsp;        return col19;</b>
&nbsp;    }
&nbsp;
&nbsp;    private ColumnMetaData buildScopeSchemaMeta() {
<b class="fc">&nbsp;        ColumnMetaData col20 = new ColumnMetaData();</b>
<b class="fc">&nbsp;        col20.setColIndex(20);</b>
<b class="fc">&nbsp;        col20.setColName(&quot;SCOPE_SCHEMA&quot;);</b>
<b class="fc">&nbsp;        col20.setColType(TSDBConstants.TSDB_DATA_TYPE_NCHAR);</b>
<b class="fc">&nbsp;        return col20;</b>
&nbsp;    }
&nbsp;
&nbsp;    private ColumnMetaData buildScopeTableMeta() {
<b class="fc">&nbsp;        ColumnMetaData col21 = new ColumnMetaData();</b>
<b class="fc">&nbsp;        col21.setColIndex(21);</b>
<b class="fc">&nbsp;        col21.setColName(&quot;SCOPE_TABLE&quot;);</b>
<b class="fc">&nbsp;        col21.setColType(TSDBConstants.TSDB_DATA_TYPE_NCHAR);</b>
<b class="fc">&nbsp;        return col21;</b>
&nbsp;    }
&nbsp;
&nbsp;    private ColumnMetaData buildSourceDataTypeMeta() {
<b class="fc">&nbsp;        ColumnMetaData col22 = new ColumnMetaData();</b>
<b class="fc">&nbsp;        col22.setColIndex(22);</b>
<b class="fc">&nbsp;        col22.setColName(&quot;SOURCE_DATA_TYPE&quot;);</b>
<b class="fc">&nbsp;        col22.setColType(TSDBConstants.TSDB_DATA_TYPE_SMALLINT);</b>
<b class="fc">&nbsp;        return col22;</b>
&nbsp;    }
&nbsp;
&nbsp;    private ColumnMetaData buildIsAutoIncrementMeta() {
<b class="fc">&nbsp;        ColumnMetaData col23 = new ColumnMetaData();</b>
<b class="fc">&nbsp;        col23.setColIndex(23);</b>
<b class="fc">&nbsp;        col23.setColName(&quot;IS_AUTOINCREMENT&quot;);</b>
<b class="fc">&nbsp;        col23.setColType(TSDBConstants.TSDB_DATA_TYPE_NCHAR);</b>
<b class="fc">&nbsp;        return col23;</b>
&nbsp;    }
&nbsp;
&nbsp;    private ColumnMetaData buildIsGeneratedColumnMeta() {
<b class="fc">&nbsp;        ColumnMetaData col24 = new ColumnMetaData();</b>
<b class="fc">&nbsp;        col24.setColIndex(24);</b>
<b class="fc">&nbsp;        col24.setColName(&quot;IS_GENERATEDCOLUMN&quot;);</b>
<b class="fc">&nbsp;        col24.setColType(TSDBConstants.TSDB_DATA_TYPE_NCHAR);</b>
<b class="fc">&nbsp;        return col24;</b>
&nbsp;    }
&nbsp;
&nbsp;    private List&lt;ColumnMetaData&gt; buildGetColumnsColumnMetaDataList() {
<b class="fc">&nbsp;        List&lt;ColumnMetaData&gt; columnMetaDataList = new ArrayList&lt;&gt;();</b>
<b class="fc">&nbsp;        columnMetaDataList.add(buildTableCatalogMeta(1));        //1. TABLE_CAT</b>
<b class="fc">&nbsp;        columnMetaDataList.add(buildTableSchemaMeta(2));         //2. TABLE_SCHEMA</b>
<b class="fc">&nbsp;        columnMetaDataList.add(buildTableNameMeta(3));           //3. TABLE_NAME</b>
<b class="fc">&nbsp;        columnMetaDataList.add(buildColumnNameMeta(4));          //4. COLUMN_NAME</b>
<b class="fc">&nbsp;        columnMetaDataList.add(buildDataTypeMeta(5));            //5. DATA_TYPE</b>
<b class="fc">&nbsp;        columnMetaDataList.add(buildTypeNameMeta(6));            //6. TYPE_NAME</b>
<b class="fc">&nbsp;        columnMetaDataList.add(buildColumnSizeMeta());                    //7. COLUMN_SIZE</b>
<b class="fc">&nbsp;        columnMetaDataList.add(buildBufferLengthMeta());                  //8. BUFFER_LENGTH, not used</b>
<b class="fc">&nbsp;        columnMetaDataList.add(buildDecimalDigitsMeta());       //9. DECIMAL_DIGITS</b>
<b class="fc">&nbsp;        columnMetaDataList.add(buildNumPrecRadixMeta());        //10. NUM_PREC_RADIX</b>
<b class="fc">&nbsp;        columnMetaDataList.add(buildNullableMeta());            //11. NULLABLE</b>
<b class="fc">&nbsp;        columnMetaDataList.add(buildRemarksMeta(12));  //12. REMARKS</b>
<b class="fc">&nbsp;        columnMetaDataList.add(buildColumnDefMeta());           //13. COLUMN_DEF</b>
<b class="fc">&nbsp;        columnMetaDataList.add(buildSqlDataTypeMeta());         //14. SQL_DATA_TYPE</b>
<b class="fc">&nbsp;        columnMetaDataList.add(buildSqlDatetimeSubMeta());      //15. SQL_DATETIME_SUB</b>
<b class="fc">&nbsp;        columnMetaDataList.add(buildCharOctetLengthMeta());     //16. CHAR_OCTET_LENGTH</b>
<b class="fc">&nbsp;        columnMetaDataList.add(buildOrdinalPositionMeta());     //17. ORDINAL_POSITION</b>
<b class="fc">&nbsp;        columnMetaDataList.add(buildIsNullableMeta());          //18. IS_NULLABLE</b>
<b class="fc">&nbsp;        columnMetaDataList.add(buildScopeCatalogMeta());        //19. SCOPE_CATALOG</b>
<b class="fc">&nbsp;        columnMetaDataList.add(buildScopeSchemaMeta());         //20. SCOPE_SCHEMA</b>
<b class="fc">&nbsp;        columnMetaDataList.add(buildScopeTableMeta());          //21. SCOPE_TABLE</b>
<b class="fc">&nbsp;        columnMetaDataList.add(buildSourceDataTypeMeta());      //22. SOURCE_DATA_TYPE</b>
<b class="fc">&nbsp;        columnMetaDataList.add(buildIsAutoIncrementMeta());     //23. IS_AUTOINCREMENT</b>
<b class="fc">&nbsp;        columnMetaDataList.add(buildIsGeneratedColumnMeta());   //24. IS_GENERATEDCOLUMN</b>
<b class="fc">&nbsp;        return columnMetaDataList;</b>
&nbsp;    }
&nbsp;
&nbsp;    public ResultSet getColumnPrivileges(String catalog, String schema, String table, String columnNamePattern) throws SQLException {
<b class="fc">&nbsp;        return getEmptyResultSet();</b>
&nbsp;    }
&nbsp;
&nbsp;    public ResultSet getTablePrivileges(String catalog, String schemaPattern, String tableNamePattern) throws SQLException {
<b class="fc">&nbsp;        return getEmptyResultSet();</b>
&nbsp;    }
&nbsp;
&nbsp;    public ResultSet getBestRowIdentifier(String catalog, String schema, String table, int scope, boolean nullable) throws SQLException {
<b class="fc">&nbsp;        return getEmptyResultSet();</b>
&nbsp;    }
&nbsp;
&nbsp;    public ResultSet getVersionColumns(String catalog, String schema, String table) throws SQLException {
<b class="fc">&nbsp;        return getEmptyResultSet();</b>
&nbsp;    }
&nbsp;
&nbsp;    public abstract ResultSet getPrimaryKeys(String catalog, String schema, String table) throws SQLException;
&nbsp;
&nbsp;    public ResultSet getImportedKeys(String catalog, String schema, String table) throws SQLException {
<b class="fc">&nbsp;        return getEmptyResultSet();</b>
&nbsp;    }
&nbsp;
&nbsp;    public ResultSet getExportedKeys(String catalog, String schema, String table) throws SQLException {
<b class="fc">&nbsp;        return getEmptyResultSet();</b>
&nbsp;    }
&nbsp;
&nbsp;    public ResultSet getCrossReference(String parentCatalog, String parentSchema, String parentTable, String foreignCatalog, String foreignSchema, String foreignTable) throws SQLException {
<b class="fc">&nbsp;        return getEmptyResultSet();</b>
&nbsp;    }
&nbsp;
&nbsp;    public ResultSet getTypeInfo() throws SQLException {
<b class="fc">&nbsp;        return getEmptyResultSet();</b>
&nbsp;    }
&nbsp;
&nbsp;    public ResultSet getIndexInfo(String catalog, String schema, String table, boolean unique, boolean approximate) throws SQLException {
<b class="fc">&nbsp;        return getEmptyResultSet();</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsResultSetType(int type) throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsResultSetConcurrency(int type, int concurrency) throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean ownUpdatesAreVisible(int type) throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean ownDeletesAreVisible(int type) throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean ownInsertsAreVisible(int type) throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean othersUpdatesAreVisible(int type) throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean othersDeletesAreVisible(int type) throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean othersInsertsAreVisible(int type) throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean updatesAreDetected(int type) throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean deletesAreDetected(int type) throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean insertsAreDetected(int type) throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsBatchUpdates() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public ResultSet getUDTs(String catalog, String schemaPattern, String typeNamePattern, int[] types) throws SQLException {
<b class="fc">&nbsp;        return getEmptyResultSet();</b>
&nbsp;    }
&nbsp;
&nbsp;    public abstract Connection getConnection() throws SQLException;
&nbsp;
&nbsp;    public boolean supportsSavepoints() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsNamedParameters() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsMultipleOpenResults() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsGetGeneratedKeys() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public ResultSet getSuperTypes(String catalog, String schemaPattern, String typeNamePattern) throws SQLException {
<b class="fc">&nbsp;        return getEmptyResultSet();</b>
&nbsp;    }
&nbsp;
&nbsp;    public abstract ResultSet getSuperTables(String catalog, String schemaPattern, String tableNamePattern) throws SQLException;
&nbsp;
&nbsp;    public ResultSet getAttributes(String catalog, String schemaPattern, String typeNamePattern, String attributeNamePattern) throws SQLException {
<b class="fc">&nbsp;        return getEmptyResultSet();</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsResultSetHoldability(int holdability) throws SQLException {
<b class="fc">&nbsp;        if (holdability == ResultSet.HOLD_CURSORS_OVER_COMMIT)</b>
<b class="fc">&nbsp;            return true;</b>
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public int getResultSetHoldability() throws SQLException {
<b class="fc">&nbsp;        return ResultSet.HOLD_CURSORS_OVER_COMMIT;</b>
&nbsp;    }
&nbsp;
&nbsp;    public int getDatabaseMajorVersion() throws SQLException {
<b class="fc">&nbsp;        return 3;</b>
&nbsp;    }
&nbsp;
&nbsp;    public int getDatabaseMinorVersion() throws SQLException {
<b class="fc">&nbsp;        return 0;</b>
&nbsp;    }
&nbsp;
&nbsp;    public int getJDBCMajorVersion() throws SQLException {
<b class="fc">&nbsp;        return 3;</b>
&nbsp;    }
&nbsp;
&nbsp;    public int getJDBCMinorVersion() throws SQLException {
<b class="fc">&nbsp;        return 0;</b>
&nbsp;    }
&nbsp;
&nbsp;    public int getSQLStateType() throws SQLException {
<b class="fc">&nbsp;        return DatabaseMetaData.sqlStateSQL99;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean locatorsUpdateCopy() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsStatementPooling() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public RowIdLifetime getRowIdLifetime() throws SQLException {
<b class="fc">&nbsp;        return null;</b>
&nbsp;    }
&nbsp;
&nbsp;    public ResultSet getSchemas(String catalog, String schemaPattern) throws SQLException {
<b class="nc">&nbsp;        return getEmptyResultSet();</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean supportsStoredFunctionsUsingCallSyntax() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean autoCommitFailureClosesAllResultSets() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    public ResultSet getClientInfoProperties() throws SQLException {
&nbsp;        //TODO: see https://docs.oracle.com/javase/8/docs/api/java/sql/Connection.html#setClientInfo-java.lang.String-java.lang.String-
<b class="fc">&nbsp;        return getEmptyResultSet();</b>
&nbsp;    }
&nbsp;
&nbsp;    public ResultSet getFunctions(String catalog, String schemaPattern, String functionNamePattern) throws SQLException {
<b class="fc">&nbsp;        return getEmptyResultSet();</b>
&nbsp;    }
&nbsp;
&nbsp;    public ResultSet getFunctionColumns(String catalog, String schemaPattern, String functionNamePattern, String columnNamePattern) throws SQLException {
<b class="fc">&nbsp;        return getEmptyResultSet();</b>
&nbsp;    }
&nbsp;
&nbsp;    public ResultSet getPseudoColumns(String catalog, String schemaPattern, String tableNamePattern, String columnNamePattern) throws SQLException {
<b class="fc">&nbsp;        return getEmptyResultSet();</b>
&nbsp;    }
&nbsp;
&nbsp;    public boolean generatedKeyAlwaysReturned() throws SQLException {
<b class="fc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    private ResultSet getEmptyResultSet() {
<b class="fc">&nbsp;        return new EmptyResultSet();</b>
&nbsp;    }
&nbsp;
&nbsp;    protected ResultSet getCatalogs(Connection conn) throws SQLException {
<b class="fc">&nbsp;        DatabaseMetaDataResultSet resultSet = new DatabaseMetaDataResultSet();</b>
&nbsp;        // set up ColumnMetaDataList
<b class="fc">&nbsp;        List&lt;ColumnMetaData&gt; columnMetaDataList = new ArrayList&lt;&gt;();</b>
<b class="fc">&nbsp;        columnMetaDataList.add(buildTableCatalogMeta(1));       // 1. TABLE_CAT</b>
<b class="fc">&nbsp;        resultSet.setColumnMetaDataList(columnMetaDataList);</b>
&nbsp;
<b class="fc">&nbsp;        String dbHelperStr = &quot;&quot;;</b>
&nbsp;
<b class="fc">&nbsp;        if (conn instanceof WSConnection) {</b>
<b class="nc">&nbsp;            WSConnection wsConnection = (WSConnection) conn;</b>
&nbsp;            //BI模式，只查询用户表，只查表，不查询子表
<b class="nc">&nbsp;            if (wsConnection.getParam().getConnectMode() == 1){</b>
<b class="nc">&nbsp;                dbHelperStr = &quot; user &quot;;</b>
&nbsp;            }
&nbsp;        }
&nbsp;
<b class="fc">&nbsp;        try (Statement stmt = conn.createStatement();</b>
<b class="fc">&nbsp;             ResultSet rs = stmt.executeQuery(&quot;show &quot; + dbHelperStr + &quot; databases&quot;)) {</b>
<b class="fc">&nbsp;            List&lt;TSDBResultSetRowData&gt; rowDataList = new ArrayList&lt;&gt;();</b>
<b class="fc">&nbsp;            while (rs.next()) {</b>
<b class="fc">&nbsp;                TSDBResultSetRowData rowData = new TSDBResultSetRowData(1);</b>
<b class="fc">&nbsp;                rowData.setStringValue(1, rs.getString(&quot;name&quot;));</b>
<b class="fc">&nbsp;                rowDataList.add(rowData);</b>
<b class="fc">&nbsp;            }</b>
<b class="fc">&nbsp;            resultSet.setRowDataList(rowDataList);</b>
<b class="fc">&nbsp;        }</b>
<b class="fc">&nbsp;        return resultSet;</b>
&nbsp;    }
&nbsp;
&nbsp;
&nbsp;    protected ResultSet getPrimaryKeys(String catalog, String schema, String table, Connection conn) throws SQLException {
<b class="fc">&nbsp;        if (catalog == null || catalog.isEmpty())</b>
<b class="nc">&nbsp;            return null;</b>
<b class="fc">&nbsp;        if (!isAvailableCatalog(conn, catalog))</b>
<b class="nc">&nbsp;            return new EmptyResultSet();</b>
&nbsp;
<b class="fc">&nbsp;        DatabaseMetaDataResultSet resultSet = new DatabaseMetaDataResultSet();</b>
<b class="fc">&nbsp;        try (Statement stmt = conn.createStatement();</b>
<b class="fc">&nbsp;             ResultSet rs = stmt.executeQuery(&quot;describe &quot; + catalog + &quot;.&quot; + table)) {</b>
&nbsp;            // set up ColumnMetaDataList
<b class="fc">&nbsp;            resultSet.setColumnMetaDataList(buildGetPrimaryKeysMetadataList());</b>
&nbsp;            // set rowData
<b class="fc">&nbsp;            List&lt;TSDBResultSetRowData&gt; rowDataList = new ArrayList&lt;&gt;();</b>
&nbsp;
<b class="fc">&nbsp;            rs.next();</b>
<b class="fc">&nbsp;            TSDBResultSetRowData rowData = new TSDBResultSetRowData(6);</b>
<b class="fc">&nbsp;            rowData.setStringValue(1, catalog);</b>
<b class="fc">&nbsp;            rowData.setStringValue(2, null);</b>
<b class="fc">&nbsp;            rowData.setStringValue(3, table);</b>
<b class="fc">&nbsp;            String primaryKey = rs.getString(&quot;field&quot;);</b>
<b class="fc">&nbsp;            rowData.setStringValue(4, primaryKey);</b>
<b class="fc">&nbsp;            rowData.setShortValue(5, (short) 1);</b>
<b class="fc">&nbsp;            rowData.setStringValue(6, primaryKey);</b>
<b class="fc">&nbsp;            rowDataList.add(rowData);</b>
<b class="fc">&nbsp;            resultSet.setRowDataList(rowDataList);</b>
<b class="fc">&nbsp;        }</b>
<b class="fc">&nbsp;        return resultSet;</b>
&nbsp;    }
&nbsp;
&nbsp;    private List&lt;ColumnMetaData&gt; buildGetPrimaryKeysMetadataList() {
<b class="fc">&nbsp;        List&lt;ColumnMetaData&gt; columnMetaDataList = new ArrayList&lt;&gt;();</b>
<b class="fc">&nbsp;        columnMetaDataList.add(buildTableCatalogMeta(1));   // 1. TABLE_CAT</b>
<b class="fc">&nbsp;        columnMetaDataList.add(buildTableSchemaMeta(2));    // 2. TABLE_SCHEM</b>
<b class="fc">&nbsp;        columnMetaDataList.add(buildTableNameMeta(3));      // 3. TABLE_NAME</b>
<b class="fc">&nbsp;        columnMetaDataList.add(buildColumnNameMeta(4));     // 4. COLUMN_NAME</b>
<b class="fc">&nbsp;        columnMetaDataList.add(buildKeySeqMeta(5));         // 5. KEY_SEQ</b>
<b class="fc">&nbsp;        columnMetaDataList.add(buildPrimaryKeyNameMeta(6)); // 6. PK_NAME</b>
<b class="fc">&nbsp;        return columnMetaDataList;</b>
&nbsp;    }
&nbsp;
&nbsp;    private ColumnMetaData buildKeySeqMeta(int colIndex) {
<b class="fc">&nbsp;        ColumnMetaData col5 = new ColumnMetaData();</b>
<b class="fc">&nbsp;        col5.setColIndex(colIndex);</b>
<b class="fc">&nbsp;        col5.setColName(&quot;KEY_SEQ&quot;);</b>
<b class="fc">&nbsp;        col5.setColType(TSDBConstants.TSDB_DATA_TYPE_SMALLINT);</b>
<b class="fc">&nbsp;        return col5;</b>
&nbsp;    }
&nbsp;
&nbsp;    private ColumnMetaData buildPrimaryKeyNameMeta(int colIndex) {
<b class="fc">&nbsp;        ColumnMetaData col6 = new ColumnMetaData();</b>
<b class="fc">&nbsp;        col6.setColIndex(colIndex);</b>
<b class="fc">&nbsp;        col6.setColName(&quot;PK_NAME&quot;);</b>
<b class="fc">&nbsp;        col6.setColType(TSDBConstants.TSDB_DATA_TYPE_NCHAR);</b>
<b class="fc">&nbsp;        return col6;</b>
&nbsp;    }
&nbsp;
&nbsp;    private boolean isAvailableCatalog(Connection connection, String catalog) throws SQLException {
<b class="fc">&nbsp;        try (Statement stmt = connection.createStatement();</b>
<b class="fc">&nbsp;             ResultSet databases = stmt.executeQuery(&quot;select name, `precision` as `precision` from information_schema.ins_databases&quot;)) {</b>
<b class="fc">&nbsp;            while (databases.next()) {</b>
<b class="fc">&nbsp;                String dbname = databases.getString(&quot;name&quot;);</b>
<b class="fc">&nbsp;                if (dbname.equalsIgnoreCase(catalog))</b>
<b class="fc">&nbsp;                    return true;</b>
<b class="fc">&nbsp;            }</b>
<b class="fc">&nbsp;        }</b>
<b class="nc">&nbsp;        return false;</b>
&nbsp;    }
&nbsp;
&nbsp;    protected ResultSet getSuperTables(String catalog, String schemaPattern, String tableNamePattern, Connection conn) throws SQLException {
<b class="fc">&nbsp;        if (catalog == null || catalog.isEmpty())</b>
<b class="nc">&nbsp;            return null;</b>
&nbsp;
<b class="fc">&nbsp;        if (!isAvailableCatalog(conn, catalog)) {</b>
<b class="nc">&nbsp;            return new EmptyResultSet();</b>
&nbsp;        }
&nbsp;
<b class="fc">&nbsp;        DatabaseMetaDataResultSet resultSet = new DatabaseMetaDataResultSet();</b>
<b class="fc">&nbsp;        try (Statement stmt = conn.createStatement()) {</b>
&nbsp;            // set up ColumnMetaDataList
<b class="fc">&nbsp;            resultSet.setColumnMetaDataList(buildGetSuperTablesColumnMetaDataList());</b>
&nbsp;            // set result set row data
<b class="fc">&nbsp;            try (ResultSet rs = stmt.executeQuery(&quot;select * from information_schema.ins_tables where db_name=&#39;&quot;</b>
&nbsp;                    + catalog + &quot;&#39; and table_name like &#39;&quot; + tableNamePattern + &quot;&#39;&quot;)) {
<b class="fc">&nbsp;                List&lt;TSDBResultSetRowData&gt; rowDataList = new ArrayList&lt;&gt;();</b>
<b class="fc">&nbsp;                while (rs.next()) {</b>
<b class="fc">&nbsp;                    TSDBResultSetRowData rowData = new TSDBResultSetRowData(4);</b>
<b class="fc">&nbsp;                    rowData.setStringValue(1, catalog);</b>
<b class="fc">&nbsp;                    rowData.setStringValue(2, null);</b>
<b class="fc">&nbsp;                    rowData.setStringValue(3, rs.getString(&quot;table_name&quot;));</b>
<b class="fc">&nbsp;                    rowData.setStringValue(4, rs.getString(&quot;stable_name&quot;));</b>
<b class="fc">&nbsp;                    rowDataList.add(rowData);</b>
<b class="fc">&nbsp;                }</b>
<b class="fc">&nbsp;                resultSet.setRowDataList(rowDataList);</b>
<b class="fc">&nbsp;            }</b>
<b class="fc">&nbsp;        }</b>
<b class="fc">&nbsp;        return resultSet;</b>
&nbsp;    }
&nbsp;
&nbsp;    private List&lt;ColumnMetaData&gt; buildGetSuperTablesColumnMetaDataList() {
<b class="fc">&nbsp;        List&lt;ColumnMetaData&gt; columnMetaDataList = new ArrayList&lt;&gt;();</b>
<b class="fc">&nbsp;        columnMetaDataList.add(buildTableCatalogMeta(1));       // 1. TABLE_CAT</b>
<b class="fc">&nbsp;        columnMetaDataList.add(buildTableSchemaMeta(2));        // 2. TABLE_SCHEM</b>
<b class="fc">&nbsp;        columnMetaDataList.add(buildTableNameMeta(3));          // 3. TABLE_NAME</b>
<b class="fc">&nbsp;        columnMetaDataList.add(buildSuperTableNameMeta(4));     // 4. SUPERTABLE_NAME</b>
<b class="fc">&nbsp;        return columnMetaDataList;</b>
&nbsp;    }
&nbsp;
&nbsp;    private ColumnMetaData buildSuperTableNameMeta(int colIndex) {
<b class="fc">&nbsp;        ColumnMetaData col4 = new ColumnMetaData();</b>
<b class="fc">&nbsp;        col4.setColIndex(colIndex);</b>
<b class="fc">&nbsp;        col4.setColName(&quot;SUPERTABLE_NAME&quot;);</b>
<b class="fc">&nbsp;        col4.setColType(TSDBConstants.TSDB_DATA_TYPE_NCHAR);</b>
<b class="fc">&nbsp;        return col4;</b>
&nbsp;    }
&nbsp;
&nbsp;}
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2023-10-08 10:56</div>
</div>
</body>
</html>
